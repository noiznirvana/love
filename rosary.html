<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide to the Rosary Mysteries</title>
    <style>
        /* Basic Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Theme Variables */
        :root {
            --bg-primary: #f8f9fa;
            --text-primary: #212529;
            --bg-secondary: #ffffff;
            --border-color: #dee2e6;
            --accent-primary: #0d6efd;
            --accent-secondary: #6c757d;
            --nav-bg: #e9ecef;
            --nav-text: #495057;
            --nav-hover-bg: #ced4da;
            --nav-link-color: #0a58ca; /* Link color */
            --footer-bg: #e9ecef;
            --footer-text: #6c757d;
            --quote-bg: #eef; /* Light blueish */
            --quote-border: #cce;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --scroll-thumb: #adb5bd;
            --scroll-track: var(--nav-bg);
            --button-control-bg: var(--accent-secondary);
            --button-control-text: var(--bg-primary);
            --button-control-hover-bg: var(--accent-primary);


            /* Mystery Specific Accents (Light Theme) */
            --joyful-accent: #f4a261; /* Orange-Yellow */
            --sorrowful-accent: #e76f51; /* Reddish-Orange */
            --glorious-accent: #2a9d8f; /* Teal */
            --luminous-accent: #e9c46a; /* Yellow */
        }

        body.dark-theme {
            --bg-primary: #1a1a1a; /* Darker gray */
            --text-primary: #f8f9fa;
            --bg-secondary: #2c2c2c; /* Slightly lighter dark gray */
            --border-color: #495057;
            --accent-primary: #4dabf7; /* Lighter blue */
            --accent-secondary: #adb5bd;
            --nav-bg: #343a40;
            --nav-text: #e9ecef;
            --nav-hover-bg: #495057;
            --nav-link-color: #69aeff; /* Lighter link color */
            --footer-bg: #343a40;
            --footer-text: #adb5bd;
            --quote-bg: #2a2a3a; /* Dark blueish */
            --quote-border: #404060;
            --shadow-color: rgba(255, 255, 255, 0.1);
            --scroll-thumb: #6c757d;
            --scroll-track: var(--nav-bg);
            --button-control-bg: var(--accent-secondary);
            --button-control-text: var(--bg-primary);
            --button-control-hover-bg: var(--accent-primary);


             /* Mystery Specific Accents (Dark Theme) */
            --joyful-accent: #f8b37a;
            --sorrowful-accent: #ec856b;
            --glorious-accent: #4fc0b3;
            --luminous-accent: #f0d086;
        }

        /* General Styles */
        html {
            scroll-behavior: smooth;
            font-size: 16px; /* Base font size - JS will modify this */
            transition: font-size 0.2s ease-in-out; /* Smooth font size change */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
            display: flex;
            flex-direction: column;
            min-height: 100vh; /* Ensure footer stays at bottom */
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: var(--scroll-track);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--scroll-thumb);
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-secondary);
        }

        /* Navigation Bar */
        .navbar {
            background-color: var(--nav-bg);
            padding: 0.8rem 1rem; /* Adjusted padding */
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px var(--shadow-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping */
            gap: 0.8rem; /* Consistent gap */
            transition: background-color 0.3s ease;
        }

        .nav-branding {
            display: flex;
            align-items: center;
            flex-wrap: wrap; /* Allow title/link wrap */
            gap: 0.5rem 1rem; /* Row and column gap */
            flex-grow: 1; /* Allow branding to take space */
        }

        .nav-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--accent-primary);
            margin: 0;
            white-space: nowrap; /* Prevent title breaking */
        }

        .nav-back-link {
            font-size: 0.9rem;
            color: var(--nav-link-color);
            text-decoration: none;
            font-weight: 500;
            padding: 0.3rem 0.6rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            white-space: nowrap;
        }
        .nav-back-link:hover {
            background-color: var(--nav-hover-bg);
            border-color: var(--nav-hover-bg);
        }

        .nav-controls {
            display: flex;
            align-items: center;
            flex-wrap: wrap; /* Allow controls to wrap */
            gap: 0.5rem 0.8rem; /* Row and column gap */
            flex-shrink: 0; /* Prevent controls shrinking too much */
        }

        .nav-links {
            list-style: none;
            display: flex;
            flex-wrap: wrap; /* Allow mystery links to wrap */
            gap: 0.5rem; /* Spacing between mystery links */
            margin: 0;
            padding: 0;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--nav-text);
            font-weight: 500;
            padding: 0.5rem 0.8rem;
            border-radius: 5px;
            transition: background-color 0.2s ease, color 0.2s ease;
            white-space: nowrap;
        }

        .nav-links a:hover, .nav-links a.active {
            background-color: var(--nav-hover-bg);
            color: var(--text-primary);
        }

        /* Font Size & Theme Controls */
         .font-controls {
            display: flex;
            gap: 0.3rem; /* Small gap between font buttons */
         }

        .font-control, .theme-toggle {
            background-color: var(--button-control-bg);
            color: var(--button-control-text);
            border: none;
            padding: 0.5rem 0.8rem; /* Adjusted padding */
            border-radius: 5px; /* Consistent radius */
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
            line-height: 1; /* Ensure consistent height */
            transition: background-color 0.3s ease, transform 0.2s ease;
            white-space: nowrap;
        }
        .theme-toggle {
            border-radius: 20px; /* Keep pill shape for theme toggle */
             padding: 0.5rem 1rem;
        }

        .font-control:hover, .theme-toggle:hover {
            background-color: var(--button-control-hover-bg);
            transform: scale(1.05);
        }

        /* Main Content Area */
        .container {
            max-width: 900px;
            width: 95%; /* Use percentage for better fluidity */
            margin: 2rem auto;
            padding: 1rem; /* Base padding */
            flex-grow: 1;
        }

        /* Mystery Section Styling */
        .mystery-section {
            background-color: var(--bg-secondary);
            margin-bottom: 2rem; /* Slightly reduced margin */
            padding: 1.5rem; /* Adjusted padding */
            border-radius: 12px;
            box-shadow: 0 4px 15px var(--shadow-color);
            border-left: 7px solid;
            transition: background-color 0.3s ease, box-shadow 0.3s ease, border-left-color 0.3s ease;
        }

        .mystery-section h2 {
            font-size: 1.8rem; /* Use rem for scaling */
            margin-bottom: 1.2rem;
            color: var(--accent-primary);
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
            display: inline-block;
        }

        /* Apply specific accent colors */
        #joyful { border-left-color: var(--joyful-accent); }
        #joyful h2 { color: var(--joyful-accent); }

        #sorrowful { border-left-color: var(--sorrowful-accent); }
        #sorrowful h2 { color: var(--sorrowful-accent); }

        #glorious { border-left-color: var(--glorious-accent); }
        #glorious h2 { color: var(--glorious-accent); }

        #luminous { border-left-color: var(--luminous-accent); }
        #luminous h2 { color: var(--luminous-accent); }

        /* Decade List */
        .decade-list {
            list-style: none;
            padding-left: 0;
        }

        .decade-item {
            margin-bottom: 1.5rem; /* Adjusted */
            padding-bottom: 1.5rem;
            border-bottom: 1px dashed var(--border-color);
        }
        .decade-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .decade-item strong {
            display: block;
            font-size: 1.2rem; /* Use rem */
            color: var(--accent-secondary);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

         .mystery-section > p { /* Paragraph directly under section */
            font-size: 0.95rem; /* Use rem */
            margin-bottom: 1rem;
            color: var(--accent-secondary);
         }

        /* Bible Verse Quote Styling */
        .bible-quote {
            background-color: var(--quote-bg);
            border-left: 5px solid var(--quote-border);
            margin: 0.8rem 0 0 0.5rem; /* Slightly reduced indent */
            padding: 0.8rem 1rem; /* Adjusted */
            border-radius: 0 8px 8px 0;
            font-style: italic;
            transition: background-color 0.3s ease, border-left-color 0.3s ease;
            font-size: 0.95rem; /* Use rem */
        }

        .bible-quote p {
            margin-bottom: 0.3rem;
        }

        .bible-quote cite {
            display: block;
            text-align: right;
            font-style: normal;
            font-size: 0.85em; /* Relative to quote font size */
            color: var(--accent-secondary);
        }

        /* Footer */
        .site-footer {
            background-color: var(--footer-bg);
            color: var(--footer-text);
            text-align: center;
            padding: 1rem;
            margin-top: 2rem;
            font-size: 0.9rem; /* Use rem */
            transition: background-color 0.3s ease, color 0.3s ease;
            flex-shrink: 0; /* Prevent footer shrinking */
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            html {
                font-size: 15px; /* Slightly smaller base on medium screens */
            }
            .nav-title {
                 font-size: 1.3rem;
             }
            .mystery-section h2 {
                font-size: 1.6rem;
            }
            .decade-item strong {
                font-size: 1.1rem;
            }
             /* Ensure controls don't overflow weirdly */
             .navbar {
                 justify-content: center; /* Center items when wrapped */
             }
             .nav-branding {
                 justify-content: center;
                 text-align: center; /* Center text within branding */
                 width: 100%; /* Allow full width */
             }
             .nav-controls {
                 justify-content: center;
                 width: 100%; /* Allow full width */
             }
        }


        @media (max-width: 480px) {
             html {
                font-size: 14px; /* Smaller base on small screens */
            }
            .navbar {
                padding: 0.6rem 0.8rem;
                gap: 0.6rem;
            }
             .nav-title {
                 font-size: 1.2rem;
             }
             .nav-back-link {
                 font-size: 0.85rem;
             }
            .nav-controls {
                gap: 0.4rem 0.6rem; /* Reduce gap further */
            }
             .nav-links a {
                 padding: 0.4rem 0.6rem;
                 font-size: 0.9rem;
             }
            .font-control, .theme-toggle {
                padding: 0.4rem 0.7rem;
                font-size: 0.85rem;
            }
            .container {
                padding: 0.8rem;
                margin: 1.5rem auto;
            }
            .mystery-section {
                padding: 1rem;
                border-left-width: 5px;
            }
            .mystery-section h2 {
                font-size: 1.4rem;
            }
            .decade-item strong {
                font-size: 1rem;
            }
            .bible-quote {
                font-size: 0.9rem;
                margin-left: 0.3rem;
                padding: 0.6rem 0.8rem;
            }
            .site-footer {
                font-size: 0.8rem;
            }
        }

    </style>
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-branding">
            <h1 class="nav-title">Rosary Guide</h1>
            <!-- !!! REPLACE # with the actual URL for the Tessera !!! -->
            <a href="https://noiznirvana.github.io/love/Tessera.html" class="nav-back-link">Back to Tessera</a>
        </div>
        <div class="nav-controls">
            <ul class="nav-links">
                <li><a href="#joyful">Joyful</a></li>
                <li><a href="#sorrowful">Sorrowful</a></li>
                <li><a href="#glorious">Glorious</a></li>
                <li><a href="#luminous">Luminous</a></li>
            </ul>
             <div class="font-controls">
                <button class="font-control" id="decrease-font" aria-label="Decrease font size">A-</button>
                <button class="font-control" id="increase-font" aria-label="Increase font size">A+</button>
            </div>
            <button class="theme-toggle" id="theme-toggle-btn">Toggle Theme</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container">

        <!-- Joyful Mysteries -->
        <section id="joyful" class="mystery-section">
            <h2>The Joyful Mysteries</h2>
            <p>(Prayed on Mondays, Saturdays, and Sundays of Advent)</p>
            <ol class="decade-list">
                <li class="decade-item">
                    <strong>1st Decade: The Annunciation</strong>
                    <blockquote class="bible-quote">
                        <p>"And the angel said to her in reply, 'The holy Spirit will come upon you, and the power of the Most High will overshadow you. Therefore the child to be born will be called holy, the Son of God.'"</p>
                        <cite>Luke 1:35</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>2nd Decade: The Visitation</strong>
                    <blockquote class="bible-quote">
                        <p>"When Elizabeth heard Mary’s greeting, the infant leaped in her womb, and Elizabeth, filled with the holy Spirit, cried out in a loud voice and said, 'Most blessed are you among women, and blessed is the fruit of your womb.'"</p>
                        <cite>Luke 1:41-42</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>3rd Decade: The Nativity of Jesus</strong>
                    <blockquote class="bible-quote">
                        <p>"And she gave birth to her firstborn son. She wrapped him in swaddling clothes and laid him in a manger, because there was no room for them in the inn."</p>
                        <cite>Luke 2:7</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>4th Decade: The Presentation in the Temple</strong>
                    <blockquote class="bible-quote">
                        <p>"Now, Master, you may let your servant go in peace, according to your word, for my eyes have seen your salvation, which you prepared in sight of all the peoples..."</p>
                        <cite>Luke 2:29-31</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>5th Decade: The Finding of Jesus in the Temple</strong>
                    <blockquote class="bible-quote">
                        <p>"He said to them, 'Why were you looking for me? Did you not know that I must be in my Father’s house?'"</p>
                        <cite>Luke 2:49</cite>
                    </blockquote>
                </li>
            </ol>
        </section>

        <!-- Sorrowful Mysteries -->
        <section id="sorrowful" class="mystery-section">
            <h2>The Sorrowful Mysteries</h2>
            <p>(Prayed on Tuesdays, Fridays, and Sundays of Lent)</p>
             <ol class="decade-list">
                <li class="decade-item">
                    <strong>1st Decade: The Agony in the Garden</strong>
                    <blockquote class="bible-quote">
                        <p>"He advanced a little and fell prostrate in prayer, saying, 'My Father, if it is possible, let this cup pass from me; yet, not as I will, but as you will.'"</p>
                        <cite>Matthew 26:39</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>2nd Decade: The Scourging at the Pillar</strong>
                    <blockquote class="bible-quote">
                        <p>"Then Pilate took Jesus and had him scourged."</p>
                        <cite>John 19:1</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>3rd Decade: The Crowning with Thorns</strong>
                    <blockquote class="bible-quote">
                        <p>"And the soldiers wove a crown out of thorns and placed it on his head, and clothed him in a purple cloak..."</p>
                        <cite>John 19:2</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>4th Decade: The Carrying of the Cross</strong>
                    <blockquote class="bible-quote">
                        <p>"And carrying the cross himself, he went out to what is called the Place of the Skull, in Hebrew, Golgotha."</p>
                        <cite>John 19:17</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>5th Decade: The Crucifixion and Death of Jesus</strong>
                    <blockquote class="bible-quote">
                        <p>"Jesus cried out in a loud voice, 'Father, into your hands I commend my spirit'; and when he had said this he breathed his last."</p>
                        <cite>Luke 23:46</cite>
                    </blockquote>
                </li>
            </ol>
        </section>

        <!-- Glorious Mysteries -->
        <section id="glorious" class="mystery-section">
            <h2>The Glorious Mysteries</h2>
            <p>(Prayed on Wednesdays and Sundays outside of Lent and Advent)</p>
             <ol class="decade-list">
                <li class="decade-item">
                    <strong>1st Decade: The Resurrection</strong>
                    <blockquote class="bible-quote">
                        <p>"He is not here; for he has been raised, as he said. Come, see the place where he lay."</p>
                        <cite>Matthew 28:6</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>2nd Decade: The Ascension</strong>
                    <blockquote class="bible-quote">
                        <p>"So then the Lord Jesus, after he spoke to them, was taken up into heaven and took his seat at the right hand of God."</p>
                        <cite>Mark 16:19</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>3rd Decade: The Descent of the Holy Spirit</strong>
                    <blockquote class="bible-quote">
                        <p>"And they were all filled with the holy Spirit and began to speak in different tongues, as the Spirit enabled them to proclaim."</p>
                        <cite>Acts 2:4</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>4th Decade: The Assumption of Mary</strong>
                    <blockquote class="bible-quote">
                        <p>"For he has looked upon his handmaid’s lowliness; behold, from now on will all ages call me blessed." (Related verse reflecting her exaltation)</p>
                        <cite>Luke 1:48</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>5th Decade: The Coronation of Mary</strong>
                    <blockquote class="bible-quote">
                        <p>"A great sign appeared in the sky, a woman clothed with the sun, with the moon under her feet, and on her head a crown of twelve stars."</p>
                        <cite>Revelation 12:1</cite>
                    </blockquote>
                </li>
            </ol>
        </section>

        <!-- Luminous Mysteries -->
        <section id="luminous" class="mystery-section">
            <h2>The Luminous Mysteries (Mysteries of Light)</h2>
            <p>(Prayed on Thursdays)</p>
             <ol class="decade-list">
                <li class="decade-item">
                    <strong>1st Decade: The Baptism of Jesus in the Jordan</strong>
                    <blockquote class="bible-quote">
                        <p>"And a voice came from the heavens, saying, 'This is my beloved Son, with whom I am well pleased.'"</p>
                        <cite>Matthew 3:17</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>2nd Decade: The Wedding at Cana</strong>
                    <blockquote class="bible-quote">
                        <p>"His mother said to the servers, 'Do whatever he tells you.'"</p>
                        <cite>John 2:5</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>3rd Decade: The Proclamation of the Kingdom of God</strong>
                    <blockquote class="bible-quote">
                        <p>"'This is the time of fulfillment. The kingdom of God is at hand. Repent, and believe in the gospel.'"</p>
                        <cite>Mark 1:15</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>4th Decade: The Transfiguration</strong>
                    <blockquote class="bible-quote">
                        <p>"While he was still speaking, behold, a bright cloud cast a shadow over them, then from the cloud came a voice that said, 'This is my beloved Son, with whom I am well pleased; listen to him.'"</p>
                        <cite>Matthew 17:5</cite>
                    </blockquote>
                </li>
                <li class="decade-item">
                    <strong>5th Decade: The Institution of the Eucharist</strong>
                    <blockquote class="bible-quote">
                        <p>"While they were eating, Jesus took bread, said the blessing, broke it, and giving it to his disciples said, 'Take and eat; this is my body.'"</p>
                        <cite>Matthew 26:26</cite>
                    </blockquote>
                </li>
            </ol>
        </section>

    </main>

    <!-- Footer -->
    <footer class="site-footer">
        Legion of Mary Mother of Divine Grace Praesidium ( noiz&may )
    </footer>

    <script>
        // --- Theme Toggle ---
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        const body = document.body;
        const currentTheme = localStorage.getItem('theme');
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');

        function applyTheme(theme) {
            if (theme === 'dark') {
                body.classList.add('dark-theme');
                themeToggleBtn.textContent = 'Light Mode';
            } else {
                body.classList.remove('dark-theme');
                themeToggleBtn.textContent = 'Dark Mode';
            }
        }

        let initialTheme = 'light'; // Default
        if (currentTheme) {
            initialTheme = currentTheme;
        } else if (prefersDarkScheme.matches) {
            initialTheme = 'dark';
        }
        applyTheme(initialTheme);

        themeToggleBtn.addEventListener('click', () => {
            let newTheme = body.classList.contains('dark-theme') ? 'light' : 'dark';
            applyTheme(newTheme);
            localStorage.setItem('theme', newTheme);
        });

        prefersDarkScheme.addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) { // Only apply if no user preference
                applyTheme(e.matches ? 'dark' : 'light');
            }
        });

        // --- Font Size Control ---
        const increaseFontBtn = document.getElementById('increase-font');
        const decreaseFontBtn = document.getElementById('decrease-font');
        const htmlElement = document.documentElement;
        const FONT_STEP = 1; // Increase/decrease by 1px
        const MIN_FONT_SIZE = 12; // Minimum base font size in px
        const MAX_FONT_SIZE = 22; // Maximum base font size in px
        const FONT_SIZE_STORAGE_KEY = 'preferredFontSize';

        function getCurrentFontSize() {
            // Get computed style, remove 'px', convert to number
            return parseFloat(window.getComputedStyle(htmlElement).fontSize);
        }

        function setFontSize(size) {
            // Clamp size between min and max
            const newSize = Math.max(MIN_FONT_SIZE, Math.min(MAX_FONT_SIZE, size));
            htmlElement.style.fontSize = newSize + 'px';
            // Save preference
            localStorage.setItem(FONT_SIZE_STORAGE_KEY, newSize + 'px');
        }

        // Apply stored font size on load
        const savedFontSize = localStorage.getItem(FONT_SIZE_STORAGE_KEY);
        if (savedFontSize) {
            // Validate stored value before applying (optional but safer)
            const savedSizeNum = parseFloat(savedFontSize);
            if (!isNaN(savedSizeNum) && savedSizeNum >= MIN_FONT_SIZE && savedSizeNum <= MAX_FONT_SIZE) {
                 htmlElement.style.fontSize = savedFontSize;
            } else {
                localStorage.removeItem(FONT_SIZE_STORAGE_KEY); // Remove invalid value
            }
        }

        increaseFontBtn.addEventListener('click', () => {
            setFontSize(getCurrentFontSize() + FONT_STEP);
        });

        decreaseFontBtn.addEventListener('click', () => {
            setFontSize(getCurrentFontSize() - FONT_STEP);
        });


        // --- Active Nav Link Highlighting ---
        const sections = document.querySelectorAll('.mystery-section');
        const navLinks = document.querySelectorAll('.nav-links a');
        const navbar = document.querySelector('.navbar');

        // Debounce function to limit scroll handler frequency
        function debounce(func, wait = 15, immediate = false) {
            let timeout;
            return function() {
                const context = this, args = arguments;
                const later = function() {
                    timeout = null;
                    if (!immediate) func.apply(context, args);
                };
                const callNow = immediate && !timeout;
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
                if (callNow) func.apply(context, args);
            };
        };

        const highlightNav = debounce(() => {
            let current = '';
            const scrollY = window.pageYOffset;
            const navHeight = navbar.offsetHeight; // Get current navbar height

            sections.forEach(section => {
                const sectionTop = section.offsetTop - navHeight - 20; // Adjust for nav height + buffer
                if (scrollY >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

             // Check if bottom of page is reached and last section isn't highlighted
             if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 50 && !current) { // 50px buffer from bottom
                // If scrolled to bottom and no section is active, activate the last one
                if (sections.length > 0) {
                    current = sections[sections.length - 1].getAttribute('id');
                }
             }


            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });

        window.addEventListener('scroll', highlightNav);
        window.addEventListener('resize', highlightNav); // Re-check on resize
        document.addEventListener('DOMContentLoaded', highlightNav); // Run once on load


    </script>

</body>
</html>
